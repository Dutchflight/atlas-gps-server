<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Atlas-gps-server by edgiru</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/edgiru/atlas-gps-server">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/edgiru/atlas-gps-server/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/edgiru/atlas-gps-server/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Atlas-gps-server</h1>
          <p>OpenSource GPS tracker system (monitoring) from user nick &quot;Mars&quot;</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/edgiru">edgiru</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h3>
<a name="%D0%9E%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5" class="anchor" href="#%D0%9E%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5"><span class="octicon octicon-link"></span></a>Описание</h3>

<p>Этот сервер был разработан не мной, а одним хорошим человеком под ником Mars. Разработчик был не против свободного распространения и изменения исходников без лицензии.
Эта версия работает, но может вылетать из-за отсутствия валидации приходящих ложных или ошибочных пакетов. Любой неправильный запрос приведет к ошибке. Над этим нужно работать далее.. </p>

<p><img src="https://lh4.googleusercontent.com/-VGSeqHLH1pA/U61bmLLtodI/AAAAAAAAyXY/4VxkTXrWsws/w1152-h597-no/11111111.jpg" alt=""></p>

<h4>
<a name="%D0%9F%D0%BE%D1%80%D1%8F%D0%B4%D0%BE%D0%BA-%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B8-%D0%B8-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B" class="anchor" href="#%D0%9F%D0%BE%D1%80%D1%8F%D0%B4%D0%BE%D0%BA-%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B8-%D0%B8-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B"><span class="octicon octicon-link"></span></a>Порядок установки и работы</h4>

<ol>
<li>Установить базу данных MySql. </li>
<li>Импортировать в базу таблицы из фала nodemonitor.sql в в папке MySQL Должны создаться база данных nodemonitor в ней две таблицы -&gt; log  и user</li>
</ol><p>Или создать вручную базу "nodemonitor"</p>

<div class="highlight highlight-js"><pre><span class="nx">log</span> <span class="o">-&gt;</span>
<span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="nx">IF</span> <span class="nx">NOT</span> <span class="nx">EXISTS</span> <span class="err">`</span><span class="nx">log</span><span class="err">`</span> <span class="p">(</span>
  <span class="err">`</span><span class="nx">id</span><span class="err">`</span> <span class="kr">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="nx">NOT</span> <span class="nx">NULL</span> <span class="nx">AUTO_INCREMENT</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">imei</span><span class="err">`</span> <span class="nx">text</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">lat</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">lng</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">speed</span><span class="err">`</span> <span class="kr">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">datetime</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">zaryad</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">azimuth</span><span class="err">`</span> <span class="kr">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">sputnik</span><span class="err">`</span> <span class="kr">int</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">tc</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">params</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">sourcedata</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="nx">PRIMARY</span> <span class="nx">KEY</span> <span class="p">(</span><span class="err">`</span><span class="nx">id</span><span class="err">`</span><span class="p">)</span>
<span class="p">)</span> <span class="nx">ENGINE</span><span class="o">=</span><span class="nx">InnoDB</span>  <span class="nx">DEFAULT</span> <span class="nx">CHARSET</span><span class="o">=</span><span class="nx">utf8</span> <span class="nx">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">104</span><span class="p">;</span>
</pre></div>

<div class="highlight highlight-js"><pre><span class="nx">user</span> <span class="o">-&gt;</span>
<span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="nx">IF</span> <span class="nx">NOT</span> <span class="nx">EXISTS</span> <span class="err">`</span><span class="nx">user</span><span class="err">`</span> <span class="p">(</span>
  <span class="err">`</span><span class="nx">id</span><span class="err">`</span> <span class="kr">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="nx">NOT</span> <span class="nx">NULL</span> <span class="nx">AUTO_INCREMENT</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">name</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">pass</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">key</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">options</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">device</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="err">`</span><span class="nx">tracks</span><span class="err">`</span> <span class="nx">text</span> <span class="nx">NOT</span> <span class="nx">NULL</span><span class="p">,</span>
  <span class="nx">PRIMARY</span> <span class="nx">KEY</span> <span class="p">(</span><span class="err">`</span><span class="nx">id</span><span class="err">`</span><span class="p">)</span>
<span class="p">)</span> <span class="nx">ENGINE</span><span class="o">=</span><span class="nx">InnoDB</span>  <span class="nx">DEFAULT</span> <span class="nx">CHARSET</span><span class="o">=</span><span class="nx">utf8</span> <span class="nx">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">6</span> <span class="p">;</span>
</pre></div>

<h4>
<a name="%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%B8%D1%82%D1%8C-nodejs-%D0%BE%D1%82%D1%81%D1%8E%D0%B4%D0%B0-httpnodejsorg" class="anchor" href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%B8%D1%82%D1%8C-nodejs-%D0%BE%D1%82%D1%81%D1%8E%D0%B4%D0%B0-httpnodejsorg"><span class="octicon octicon-link"></span></a>Установить Node.js отсюда: <a href="http://nodejs.org/">http://nodejs.org/</a>
</h4>

<p>Войти в черный экран (для виндовс Пуск -&gt; Выполнить  : Набрать в окошке cmd и нажать Ok)<br>
Перейти в директорию куда вы разархивировали проект   D: ввод <br>
D:&gt;  cd ./atlas/webserver   ввод (или клавиша энтер ее называют)<br>
Должно получится <br>
D:&gt; atlas/webserver &gt;   <br></p>

<p>Далее в этой строчке набираете  D:&gt; atlas/webserver &gt;   node web-server.js<br>
На этом этапе должна быть ошибка .. много надписей. В самом ER_ACCESS_DENITED_ERROR  бла бла… <br></p>

<p>Это значит что сервер не может подсоединиться к базе данных. В файле папка webserver Фалик web-config.json <br></p>

<div class="highlight highlight-js"><pre><span class="p">{</span>
    <span class="s2">"port"</span><span class="o">:</span> <span class="mi">5000</span><span class="p">,</span>   
    <span class="s2">"public"</span> <span class="o">:</span> <span class="s2">"../public"</span><span class="p">,</span>  
    <span class="s2">"mysql"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"host"</span><span class="o">:</span><span class="s2">"localhost"</span><span class="p">,</span>
        <span class="s2">"user"</span><span class="o">:</span><span class="s2">"admin"</span><span class="p">,</span>     <span class="c1">//"admin"  пользователь который имеет право подключиться к базе (часто это root)</span>
        <span class="s2">"password"</span><span class="o">:</span><span class="s2">"pass_from_database"</span><span class="p">,</span>    <span class="c1">//"password"  пароль от этой базы данных. В нашем случае от базы nodemonitoring  меняете на свой</span>
        <span class="s2">"database"</span><span class="o">:</span><span class="s2">"nodemonitor"</span>    <span class="c1">//"database"  сама наша база (ее имя)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Вам надо добиться чтобы при запуске сервер (выполнения команды в командной строке node web-server.js ) выдал сделующие строки:</p>

<div class="highlight highlight-js"><pre><span class="nx">controllers</span> <span class="nx">add</span>
<span class="nx">Server</span> <span class="nx">listening</span> <span class="nx">on</span><span class="o">:</span> <span class="mi">5000</span>
<span class="nx">GPSMarker</span> <span class="nx">listening</span> <span class="mi">3128</span>
<span class="nx">GpsLogger</span> <span class="nx">listening</span> <span class="mi">10100</span>
<span class="nx">GpsGate</span> <span class="nx">listening</span> <span class="mi">10005</span>
<span class="nx">Profiler</span> <span class="nx">listening</span> <span class="nx">on</span> <span class="mf">0.0</span><span class="p">.</span><span class="mf">0.0</span><span class="o">:</span><span class="mi">3131</span>
</pre></div>

<p>Если удалось завести таблицы и стартовать сервер, открываем браузер и переходим по адресу<br>
http://localhost:5000<br>
5000 – это  "port": 5000,   web-config.json (вы можете изменить на любой другой свободный у вас порт к примеру: 80)</p>

<p>Если вы создавали таблицу в базе данных импортом, то по умолчанию можно войти под</p>

<p>login: demo<br>
pass:  demo</p>

<p>Сервер неустойчиво, но работает для GPS Logger for Android </p>

<p><a href="https://play.google.com/store/apps/details?id=com.mendhak.gpslogger&amp;hl=ru">https://play.google.com/store/apps/details?id=com.mendhak.gpslogger&amp;hl=ru</a></p>

<p>Его настроки:<br>
Настройки -&gt; Автоматическая отрпавка – OpenGTS настройка<br>
Включить OpenGTS  -&gt; галка<br>
Включить автоматическую отправку координат -&gt; галка<br>
Сервер -&gt; ip вашего сервера (нужно узнать ip вашего компьютера например по ссылке <a href="http://2ip.ru/">http://2ip.ru/</a> )<br>
Порт  - &gt; 10100 (по умолчанию у меня забито среди кода)<br>
Идентификатор устройства – &gt; 123456789012345  (по умолчанию для пользователя: demo пароль: demo)<br></p>

<p>На этом этапе должно уже работать. </p>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>